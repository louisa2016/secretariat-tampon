<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Endossaire Pro - Coll√®ge Katherine Johnson</title>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <style>
        :root {
            --blue-france: #000091;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: "Marianne", sans-serif;
            background: #f5f5f5;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        header {
            background: white;
            padding: 10px 20px;
            border-bottom: 2px solid var(--blue-france);
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
            flex-shrink: 0;
            z-index: 10;
        }

        .main-layout {
            display: flex;
            flex: 1;
            overflow: hidden;
            width: 100%;
        }

        /* Sidebars */
        .sidebar {
            width: 280px;
            background: white;
            padding: 15px;
            overflow-y: auto;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sidebar-left {
            border-right: 1px solid #ddd;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.03);
        }

        .sidebar-right {
            border-left: 1px solid #ddd;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.03);
        }

        .workspace {
            flex: 1;
            overflow: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background: #e5e5e5;
        }

        .canvas-wrapper {
            position: relative;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }

        #delete-control {
            display: none;
            position: absolute;
            z-index: 1000;
            background: #ff4d4d;
            color: white;
            border: none;
            border-radius: 50%;
            width: 26px;
            height: 26px;
            cursor: pointer;
            font-weight: bold;
            line-height: 26px;
            text-align: center;
            padding: 0;
        }

        /* Elements UI */
        h3 {
            font-size: 1rem;
            color: #333;
            margin: 5px 0 10px 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }

        .stamp-card {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: 0.2s;
        }

        .stamp-card:hover {
            border-color: var(--blue-france);
        }

        .stamp-card.active {
            border: 2px solid var(--blue-france);
            background: #eef;
        }

        .stamp-card svg {
            width: 80px;
            height: 80px;
            pointer-events: none;
        }

        #drop-zone {
            border: 2px dashed #ccc;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            font-size: 0.9em;
        }

        .pos-btn {
            background: #eee;
            border: 1px solid #ccc;
            cursor: pointer;
            font-size: 1.1em;
            padding: 8px;
            border-radius: 4px;
        }

        .pos-btn.selected {
            background: var(--blue-france);
            color: white;
        }

        button {
            background: var(--blue-france);
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .info-box {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 0.85em;
        }
    </style>
</head>

<body>
    <header>
        <h2 style="color: var(--blue-france); margin:0;">Endossaire</h2>
        <p style="color: grey">‚ö†Ô∏è<small><i>Risque de bugs avec les pdf complexes : Faire fichier->imprimer "Enregistrer
                    au format PDF" avant</i></small></p>
        <div id="file-info" style="font-weight: bold;">Aucun fichier charg√©</div>
    </header>
    <div class="main-layout">
        <div class="sidebar sidebar-left">
            <h3>1. Fichier PDF</h3>
            <div id="drop-zone">üìÅ Charger un document</div>
            <input type="file" id="file-input" accept="application/pdf" style="display:none">
            <h3>2. Biblioth√®que</h3>
            <div id="selector">
                <div class="stamp-card active" data-stamp="principalsign-stamp" onclick="selectStamp(this)">
                    <small>Principal Sign√©</small>
                    <div class="preview" id="p1"></div>
                </div>
                <div class="stamp-card" data-stamp="principal-stamp" onclick="selectStamp(this)">
                    <small>Principal</small>
                    <div class="preview" id="p2"></div>
                </div>
                <div class="stamp-card" data-stamp="adjoint-stamp" onclick="selectStamp(this)">
                    <small>Adjoint</small>
                    <div class="preview" id="p3"></div>
                </div>
                <div class="stamp-card" data-stamp="secretariat-stamp" onclick="selectStamp(this)">
                    <small>Secr√©tariat</small>
                    <div class="preview" id="p4"></div>
                </div>
                <div class="stamp-card" data-stamp="gestion-stamp" onclick="selectStamp(this)">
                    <small>Gestion</small>
                    <div class="preview" id="p5"></div>
                </div>
            </div>
        </div>
        <div class="workspace">
            <div
                style="margin-bottom: 15px; display: flex; gap: 15px; align-items: center; background: white; padding: 8px 20px; border-radius: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                <button id="prev-page" style="width: 40px; margin: 0; padding: 5px;">&lt;</button>
                <span style="font-weight: bold; color: #333; display: flex; align-items: center; gap: 8px;">
                    Page
                    <input autocomplete="off" type="number" id="current-page-input" value="1" min="1"
                        style="width: 55px; text-align: center; border: 1px solid var(--blue-france); border-radius: 4px; padding: 3px;">
                    / <span id="total-pages">1</span>
                </span>
                <button id="next-page" style="width: 40px; margin: 0; padding: 5px;">&gt;</button>
                <div style="width: 1px; height: 25px; background: #ddd; margin: 0 10px;"></div>
                <span style="font-weight: bold; color: #333;">Zoom :</span>
                <select autocomplete="off" id="zoom-select"
                    style="padding: 5px; border-radius: 4px; border: 1px solid var(--blue-france);">
                    <option value="0.5">50%</option>
                    <option value="0.75">75%</option>
                    <option value="1" selected>100%</option>
                    <option value="1.25">125%</option>
                    <option value="1.5">150%</option>
                    <option value="2">200%</option>
                </select>
            </div>
            <div class="canvas-wrapper" id="scroll-container"
                style="max-width: 100%; max-height: 80vh; overflow: auto;">
                <button id="delete-control">‚úï</button>
                <canvas id="pdf-canvas"></canvas>
            </div>
        </div>
        <div class="sidebar sidebar-right">
            <h3>3. Statistiques</h3>
            <div class="info-box" style="border-left: 4px solid var(--blue-france);">
                üìä <b>Total : <span id="stat-count">0</span> tampon(s)</b>
                <button id="btn-clear-page"
                    style="background: white; color: #d00; border: 1px solid #d00; font-size: 0.8em; padding: 5px; margin-top: 10px;">
                    üóëÔ∏è Vider cette page
                </button>
            </div>
            <h3>4. R√©glages auto</h3>
            <div class="info-box">
                <label><b>Taille par d√©faut (px) :</b></label>
                <input type="number" id="pref-size" value="100"
                    style="width: 100%; margin: 8px 0 15px 0; padding: 5px;">
                <label><b>Position d'insertion :</b></label>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; margin: 10px 0;">
                    <button class="pos-btn" data-v="top" data-h="left">‚Üñ</button>
                    <button class="pos-btn" data-v="top" data-h="center">‚Üë</button>
                    <button class="pos-btn" data-v="top" data-h="right">‚Üó</button>
                    <button class="pos-btn" data-v="middle" data-h="left">‚Üê</button>
                    <button class="pos-btn" data-v="middle" data-h="center">‚óè</button>
                    <button class="pos-btn" data-v="middle" data-h="right">‚Üí</button>
                    <button class="pos-btn" data-v="bottom" data-h="left">‚Üô</button>
                    <button class="pos-btn" data-v="bottom" data-h="center">‚Üì</button>
                    <button class="pos-btn" data-v="bottom" data-h="right" id="default-pos">‚Üò</button>
                </div>
                <button id="btn-save-prefs" style="background: #666; font-size: 0.8em; padding: 8px;">üíæ
                    M√©moriser</button>
            </div>
            <div style="margin-top: auto; padding-top: 20px;">
                <h3>5. Export</h3>
                <button id="btn-export" disabled style="height: 60px; font-size: 1.1em;">T√âL√âCHARGER LE PDF</button>
            </div>
        </div>
    </div>
    <div style="display:none" id="svg-library">
        <svg id="principalsign-stamp" version="1.0" xmlns="http://www.w3.org/2000/svg" width="338.000000pt"
            height="273.000000pt" viewBox="0 0 338.000000 273.000000" preserveAspectRatio="xMidYMid meet">
            <g transform="translate(0.000000,273.000000) scale(0.100000,-0.100000)" fill="#000091" stroke="none">
                <path d="M2285 2594 c-354 -55 -628 -303 -712 -643 -17 -70 -26 -302 -13 -336
5 -11 16 -49 26 -85 10 -36 30 -91 46 -122 15 -32 28 -61 28 -65 0 -4 -21 -17
-48 -27 -26 -10 -82 -35 -125 -54 -49 -22 -81 -32 -87 -26 -13 13 64 299 103
381 13 28 0 44 -16 22 -7 -8 -39 -21 -72 -28 -163 -36 -473 -160 -458 -184 3
-5 8 -5 12 1 21 34 473 194 492 175 5 -5 3 -25 -5 -48 -39 -107 -96 -295 -96
-314 0 -16 -10 -26 -36 -37 -20 -8 -42 -13 -50 -10 -7 3 -15 0 -17 -7 -7 -20
-16 -4 -21 38 -7 58 5 235 17 235 6 0 8 -47 5 -125 -3 -69 -2 -125 2 -125 11
0 23 202 15 250 -7 39 -20 58 -32 46 -3 -3 -12 -49 -19 -103 -19 -135 -12
-302 17 -378 21 -56 21 -59 3 -72 -26 -19 -34 -4 -38 71 -2 38 -9 73 -15 79
-15 15 -14 44 2 51 6 4 -4 4 -23 0 -19 -3 -50 -7 -68 -9 -44 -4 -54 -15 -14
-15 22 0 32 -5 32 -15 0 -20 10 -19 26 3 11 16 13 15 23 -11 24 -63 6 -200
-29 -222 -22 -14 -30 19 -25 105 4 63 3 81 -5 68 -13 -21 -18 -156 -7 -179 6
-13 -26 -39 -165 -131 -235 -157 -336 -213 -446 -248 -115 -37 -171 -39 -209
-6 -25 22 -28 31 -27 83 2 107 96 291 239 468 100 126 271 271 410 352 22 12
34 23 27 23 -22 0 -202 -123 -287 -197 -77 -67 -156 -152 -221 -238 -86 -113
-178 -307 -188 -396 -8 -65 5 -94 54 -120 121 -65 332 37 939 455 69 47 126
84 128 83 4 -5 -24 -179 -42 -252 -43 -183 -86 -475 -84 -570 l2 -50 8 50 c4
28 17 122 29 210 11 88 34 216 50 285 17 68 39 176 49 238 10 63 25 120 32
127 8 8 82 59 164 114 l150 99 53 -58 c202 -225 529 -325 820 -250 314 80 551
324 617 635 109 508 -265 990 -785 1009 -58 3 -118 2 -135 0z m301 -38 c141
-39 253 -100 356 -195 204 -188 299 -460 254 -725 -56 -331 -276 -574 -602
-668 -117 -33 -304 -31 -427 6 -143 43 -239 98 -341 195 -50 49 -136 152 -136
164 0 6 42 20 53 18 13 -2 91 41 110 61 15 15 22 17 33 7 25 -21 15 -37 -42
-65 -44 -22 -53 -29 -39 -34 17 -6 17 -7 2 -13 -27 -10 -32 15 -7 35 12 10 21
21 18 23 -8 9 -58 -35 -58 -51 0 -8 -7 -14 -15 -14 -8 0 -15 -4 -15 -10 0 -5
9 -10 20 -10 11 0 20 5 20 11 0 8 4 8 14 0 11 -10 21 -5 48 21 80 78 71 77
125 23 166 -165 402 -223 617 -151 98 33 152 64 222 129 94 86 152 185 183
314 89 376 -207 743 -601 743 -141 0 -308 -73 -417 -181 -120 -119 -189 -299
-179 -466 l5 -73 -51 -2 -51 -1 53 -6 53 -6 23 -65 c12 -36 30 -79 38 -95 16
-30 16 -31 -17 -52 -29 -19 -34 -20 -48 -6 -14 15 -18 15 -42 -1 -14 -9 -24
-24 -23 -34 2 -10 -3 -16 -11 -14 -8 2 -18 -2 -22 -9 -10 -17 -62 89 -88 181
-18 66 -19 76 -6 86 21 16 19 24 -6 24 -22 0 -22 2 -16 128 4 84 13 152 27
201 81 284 301 498 593 576 82 22 106 24 217 20 69 -3 148 -11 176 -19z m-76
-221 c224 -47 386 -205 450 -438 24 -87 22 -186 -5 -290 -48 -185 -194 -339
-381 -403 -226 -78 -494 -1 -640 185 -39 49 -42 57 -28 66 73 44 92 86 54 120
-11 10 -20 13 -20 7 0 -6 5 -14 10 -17 19 -12 10 -44 -22 -74 -18 -17 -37 -31
-41 -31 -12 0 -59 111 -62 145 -1 17 -7 40 -14 52 -6 12 -11 52 -11 90 1 165
60 314 170 423 150 151 337 208 540 165z m-725 -924 c7 -12 -35 -42 -47 -35
-5 3 -2 15 8 25 19 21 30 24 39 10z m-92 -115 c16 -24 16 -24 -129 -121 -80
-54 -147 -95 -149 -93 -7 6 35 131 49 145 12 13 184 91 202 92 7 1 19 -10 27
-23z m-263 -83 c0 -19 -47 -150 -57 -161 -7 -7 -13 -18 -13 -23 0 -5 -4 -9
-10 -9 -13 0 -13 70 0 90 8 13 10 12 11 -5 1 -11 1 -24 -1 -30 -1 -7 2 -7 9 0
5 6 11 33 12 60 3 58 14 85 34 85 8 0 15 -3 15 -7z m-106 -122 c-14 -89 -23
-107 -47 -98 -17 6 -40 102 -35 144 2 22 10 30 43 39 22 6 43 9 46 5 4 -3 1
-44 -7 -90z m-122 -163 c-15 -15 -26 -4 -18 18 5 13 9 15 18 6 9 -9 9 -15 0
-24z" />
                <path d="M2312 2513 c-21 -4 -23 -9 -20 -56 3 -52 3 -52 38 -53 26 -1 28 -1 8
3 -19 3 -28 10 -28 24 0 10 6 19 13 19 6 0 4 5 -5 11 -26 15 -22 34 10 46 28
11 23 13 -16 6z" />
                <path d="M2377 2513 c-11 -10 -8 -103 3 -103 6 0 10 9 10 20 0 29 25 25 39 -6
6 -15 14 -24 17 -21 3 3 0 15 -6 27 -9 16 -9 25 -1 33 16 16 13 44 -5 51 -21
8 -49 8 -57 -1z m52 -16 c8 -10 7 -17 -1 -25 -18 -18 -38 -14 -38 6 0 32 20
42 39 19z" />
                <path d="M2477 2497 c-4 -10 -7 -37 -6 -60 l1 -42 9 45 c10 52 8 87 -4 57z" />
                <path d="M2247 2476 c4 -19 0 -24 -22 -29 -21 -3 -29 0 -32 14 -3 11 -9 19
-12 19 -4 0 -3 -22 3 -50 10 -53 29 -70 24 -22 -3 23 1 27 23 30 22 3 28 -2
33 -24 4 -14 9 -24 13 -21 7 7 -19 107 -28 107 -3 0 -4 -11 -2 -24z" />
                <path d="M2511 2463 c-6 -21 -11 -47 -11 -58 0 -17 2 -17 10 -5 5 8 10 28 10
43 0 38 17 25 31 -23 7 -22 16 -40 20 -40 9 0 29 65 29 95 0 17 -2 17 -10 5
-5 -8 -10 -28 -10 -44 0 -37 -13 -25 -30 27 -6 20 -15 37 -20 37 -5 0 -14 -17
-19 -37z" />
                <path d="M2113 2468 c-35 -11 -45 -27 -16 -24 11 1 22 -13 32 -39 17 -46 19
-50 26 -43 3 3 -2 22 -11 44 -12 29 -13 43 -5 56 6 10 10 18 9 17 -2 -1 -18
-6 -35 -11z" />
                <path d="M2620 2445 c-24 -64 -24 -74 5 -85 15 -6 30 -8 33 -6 3 3 -7 10 -21
15 -36 14 -26 45 12 36 l26 -6 -22 18 c-30 24 -16 51 17 33 12 -6 24 -9 27 -6
6 5 -40 26 -58 26 -5 0 -14 -11 -19 -25z" />
                <path d="M2025 2365 c3 -30 4 -55 1 -55 -2 0 -16 4 -30 10 -20 7 -26 17 -27
42 l-1 33 -10 -38 c-10 -37 -11 -37 -29 -21 -11 9 -19 14 -19 10 0 -12 54 -86
63 -86 10 0 9 18 -3 25 -24 15 -7 25 30 19 35 -6 40 -4 40 12 0 27 37 49 56
33 9 -7 14 -8 14 -1 0 11 -72 72 -85 72 -4 0 -4 -25 0 -55z m45 4 c0 -4 -7 -9
-15 -13 -8 -3 -15 -1 -15 3 0 5 -3 17 -6 26 -6 15 -4 15 15 4 11 -8 21 -17 21
-20z" />
                <path d="M2771 2355 c-21 -36 -51 -47 -51 -20 0 8 -5 15 -11 15 -15 0 -6 -21
14 -34 11 -7 22 -8 33 -1 20 13 59 75 46 75 -6 0 -19 -16 -31 -35z" />
                <path d="M1885 2370 c-3 -6 1 -7 9 -4 18 7 21 14 7 14 -6 0 -13 -4 -16 -10z" />
                <path d="M2802 2337 c-37 -39 -24 -87 24 -87 41 0 71 69 42 98 -18 18 -42 14
-66 -11z m63 -7 c10 -16 -5 -49 -27 -61 -16 -9 -24 -8 -36 4 -14 14 -13 18 2
41 17 26 50 35 61 16z" />
                <path d="M2875 2260 c-37 -38 -41 -57 -5 -25 15 14 19 13 35 -5 17 -19 17 -21
0 -40 -31 -34 -1 -22 33 13 35 36 44 61 12 32 -11 -10 -21 -16 -23 -14 -1 2
-9 12 -16 22 -11 14 -11 20 -1 32 28 34 1 22 -35 -15z" />
                <path d="M1824 2269 c-19 -21 -18 -21 18 -55 21 -19 41 -34 46 -34 5 0 19 12
33 27 21 24 21 25 2 9 -12 -10 -29 -16 -38 -13 -17 7 -20 23 -5 32 6 3 10 11
10 17 0 6 -9 3 -20 -7 -16 -14 -23 -16 -32 -7 -9 9 -7 16 7 32 10 11 14 20 8
20 -5 0 -18 -9 -29 -21z" />
                <path d="M2945 2185 c-28 -19 -43 -35 -34 -35 9 0 22 7 29 15 7 8 19 15 26 15
11 0 10 -9 -6 -41 -12 -23 -19 -43 -16 -46 3 -3 27 7 53 23 26 15 42 29 35 32
-7 2 -22 -4 -33 -14 -27 -24 -32 -13 -14 30 9 21 15 42 13 47 -2 6 -26 -6 -53
-26z" />
                <path d="M1762 2193 c-19 -37 19 -83 68 -83 30 0 49 45 28 67 -9 8 -21 12 -27
9 -17 -11 -13 -24 7 -22 22 1 22 -23 1 -37 -13 -8 -24 -6 -43 6 -32 21 -34 54
-3 67 l22 9 -22 0 c-12 1 -26 -7 -31 -16z" />
                <path d="M3029 2193 c-13 -16 -12 -17 4 -4 16 13 21 21 13 21 -2 0 -10 -8 -17
-17z" />
                <path d="M1715 2110 l-15 -29 46 -27 46 -27 19 24 c10 13 19 29 19 34 0 6 -8
0 -18 -13 -12 -15 -24 -21 -35 -16 -19 7 -22 20 -7 29 6 3 10 12 10 18 0 7 -8
2 -18 -10 -24 -31 -47 -17 -33 20 14 36 5 34 -14 -3z" />
                <path d="M3019 2093 c-1 -10 -2 -27 -3 -38 -2 -32 -31 -25 -31 8 1 15 -3 27
-7 27 -13 0 -9 -44 5 -64 21 -29 47 -10 47 35 0 27 4 39 14 39 17 0 27 -24 19
-47 -5 -14 -3 -16 7 -6 21 20 4 63 -25 63 -17 0 -25 -6 -26 -17z" />
                <path d="M3045 2021 c-37 -15 -49 -39 -37 -66 13 -27 37 -32 76 -14 32 15 37
30 22 60 -13 26 -31 32 -61 20z m53 -37 c2 -16 -5 -25 -29 -34 -28 -12 -33
-12 -46 6 -12 17 -11 21 8 37 29 23 63 18 67 -9z" />
                <path d="M1773 2002 c-6 -26 -8 -26 -62 -7 -22 8 -41 11 -41 6 0 -4 18 -14 41
-21 47 -16 50 -19 42 -49 -5 -21 -10 -22 -57 -16 -60 7 -44 -9 19 -19 l40 -7
17 63 c9 35 14 65 12 68 -3 2 -7 -6 -11 -18z" />
                <path d="M3065 1914 l-50 -13 44 4 43 3 -31 -32 c-44 -46 -41 -55 19 -42 28 5
50 13 50 17 0 4 -16 3 -35 -1 -43 -10 -44 0 -5 33 17 14 30 30 30 36 0 13 -1
13 -65 -5z" />
                <path d="M1642 1868 c-29 -29 3 -78 51 -78 23 0 57 31 57 52 0 31 -82 52 -108
26z m72 -4 c9 -3 16 -17 16 -30 0 -21 -5 -24 -34 -24 -19 0 -39 7 -47 16 -11
14 -10 18 6 30 21 15 35 17 59 8z" />
                <path d="M1643 1773 c-7 -3 -13 -18 -13 -34 0 -37 34 -56 77 -42 44 15 43 83
-2 83 -5 -1 -2 -7 8 -15 10 -7 17 -22 15 -32 -5 -27 -81 -26 -86 1 -2 10 2 22
9 27 16 9 9 18 -8 12z" />
                <path d="M3051 1743 l-1 -33 50 0 50 0 -1 33 c-2 30 -2 30 -6 5 -3 -19 -10
-28 -23 -28 -13 0 -20 9 -23 28 l-4 27 -2 -27 c0 -17 -7 -28 -15 -28 -8 0 -17
12 -19 28 -4 25 -4 25 -6 -5z" />
                <path d="M3040 1648 c0 -5 15 -8 34 -8 19 0 41 -3 50 -6 10 -4 16 -1 16 7 0
10 -15 14 -50 14 -28 0 -50 -3 -50 -7z" />
                <path d="M1658 1643 c7 -3 16 -2 19 1 4 3 -2 6 -13 5 -11 0 -14 -3 -6 -6z" />
                <path d="M1688 1598 c-40 -11 -48 -30 -25 -61 11 -15 16 -15 52 -3 22 8 40 19
39 25 -1 6 -2 20 -2 31 -2 22 -9 23 -64 8z m52 -29 c0 -24 -23 -21 -28 4 -2
10 3 17 12 17 10 0 16 -9 16 -21z m-40 -9 c0 -23 -25 -27 -33 -6 -7 16 1 26
20 26 7 0 13 -9 13 -20z" />
                <path d="M3120 1594 c0 -14 -8 -16 -47 -11 -54 7 -39 -7 18 -17 33 -6 37 -4
41 19 3 14 1 25 -3 25 -5 0 -9 -7 -9 -16z" />
                <path d="M3045 1545 c17 -8 41 -14 55 -14 23 0 23 1 5 8 -11 5 -36 11 -55 15
l-35 6 30 -15z" />
                <path d="M3006 1524 c-11 -29 -6 -44 17 -53 59 -22 63 -22 76 5 6 15 10 29 7
31 -2 2 -7 -5 -11 -16 -3 -12 -15 -21 -26 -21 -22 0 -23 4 -9 31 6 11 7 19 1
19 -5 0 -11 -7 -15 -15 -3 -8 -12 -15 -21 -15 -11 0 -14 6 -9 25 7 28 0 34
-10 9z" />
                <path d="M1692 1508 c-16 -16 -15 -47 1 -54 7 -2 33 4 58 15 39 17 41 20 17
20 -14 1 -28 -3 -30 -8 -1 -5 -12 -11 -23 -13 -14 -2 -20 3 -20 17 0 15 7 20
28 20 15 -1 27 3 27 7 0 12 -45 9 -58 -4z" />
                <path d="M2983 1463 c-7 -3 -13 -14 -13 -25 0 -11 -11 -31 -25 -44 -14 -13
-25 -27 -25 -31 1 -12 80 -66 80 -54 0 5 -4 13 -10 16 -20 12 -9 25 23 26 21
1 25 3 12 6 -11 3 -25 12 -31 21 -9 13 -12 11 -18 -11 -4 -18 -11 -24 -21 -21
-26 10 -16 33 20 49 20 8 43 21 52 30 12 12 19 13 27 5 8 -8 5 -16 -13 -31
-17 -14 -19 -19 -7 -19 19 0 40 36 32 56 -7 18 -30 18 -46 -1 -7 -8 -19 -15
-26 -15 -17 0 -18 27 -1 33 6 2 10 7 7 9 -3 3 -11 3 -17 1z" />
                <path d="M2890 1318 c0 -7 12 -31 26 -53 14 -22 23 -33 21 -25 -7 22 19 54 38
47 8 -4 15 -4 15 -1 0 4 -86 44 -96 44 -2 0 -4 -6 -4 -12z m45 -18 c3 -5 3
-15 -1 -21 -6 -11 -23 6 -24 24 0 10 18 9 25 -3z" />
                <path d="M1860 1275 c-33 -34 -33 -35 -15 -55 25 -27 37 -25 63 10 25 33 27
51 10 68 -17 17 -20 16 -58 -23z m56 4 c3 -6 2 -15 -2 -19 -12 -12 -38 5 -30
19 9 14 23 14 32 0z m-29 -35 c9 -23 -11 -38 -26 -20 -13 16 -7 36 10 36 5 0
12 -7 16 -16z" />
                <path d="M2855 1268 c3 -13 9 -34 12 -46 l6 -24 -42 21 c-52 27 -55 9 -6 -39
19 -19 35 -29 35 -24 0 6 -9 19 -20 29 -27 25 -18 31 14 9 33 -21 41 -14 28
25 -13 36 0 41 22 9 9 -12 16 -17 16 -11 0 15 -49 73 -62 73 -6 0 -7 -9 -3
-22z" />
                <path d="M1985 1241 c-3 -5 -2 -12 3 -15 5 -3 9 1 9 9 0 17 -3 19 -12 6z" />
                <path d="M1908 1205 c-10 -21 -9 -29 5 -43 24 -23 52 -5 52 34 0 40 -40 47
-57 9z m48 0 c8 -20 -13 -45 -32 -38 -17 6 -18 25 -2 41 16 16 27 15 34 -3z" />
                <path d="M2737 1195 c-28 -20 -18 -50 17 -50 37 0 45 -22 14 -35 l-23 -10 25
3 c19 1 25 8 25 26 0 30 -31 53 -44 32 -7 -10 -10 -11 -16 -1 -5 8 -1 18 10
26 10 8 17 16 14 18 -2 2 -12 -2 -22 -9z" />
                <path d="M1980 1167 c0 -7 5 -18 12 -25 17 -17 1 -27 -18 -11 -15 12 -17 12
-12 -1 7 -23 48 -26 48 -3 0 11 -5 24 -12 31 -9 9 -8 12 4 12 24 0 29 -27 13
-67 -8 -20 -13 -38 -10 -41 2 -3 7 2 11 11 4 13 10 14 24 7 22 -12 50 11 50
40 0 20 -34 45 -49 36 -5 -3 -11 1 -15 9 -7 18 -46 20 -46 2z m94 -36 c10 -16
-5 -41 -25 -41 -22 0 -23 4 -9 31 11 20 25 25 34 10z" />
                <path d="M2660 1145 c-10 -12 -10 -15 5 -15 9 0 22 -13 28 -30 6 -16 15 -30
19 -30 9 0 -17 69 -31 83 -4 4 -14 1 -21 -8z" />
                <path d="M2099 1105 c-18 -48 -10 -62 10 -19 6 14 17 24 24 21 13 -5 13 -9 2
-47 -5 -17 -4 -22 3 -15 6 6 14 22 17 37 5 21 3 27 -15 33 -13 4 -19 12 -16
21 3 8 2 14 -2 14 -4 0 -14 -20 -23 -45z" />
                <path d="M2603 1133 c-19 -7 -16 -57 5 -83 27 -33 56 -17 49 27 -6 34 -23 64
-36 62 -3 0 -12 -3 -18 -6z m40 -58 c1 -15 -3 -30 -9 -32 -15 -5 -38 52 -30
74 6 15 8 15 22 2 8 -9 16 -28 17 -44z" />
                <path d="M2538 1112 c-10 -2 -18 -11 -18 -20 0 -14 2 -14 9 -3 5 8 16 11 26 7
13 -5 15 -9 6 -20 -9 -11 -8 -15 5 -20 9 -4 14 -13 10 -21 -3 -8 -1 -15 4 -15
13 0 13 37 0 45 -5 3 -7 12 -4 19 6 17 -16 34 -38 28z" />
                <path d="M2809 1093 c-13 -16 -12 -17 4 -4 16 13 21 21 13 21 -2 0 -10 -8 -17
-17z" />
                <path d="M2171 1086 c-21 -25 -10 -61 18 -61 31 0 50 28 35 53 -15 23 -38 26
-53 8z m36 -7 c14 -14 5 -49 -13 -49 -18 0 -26 17 -19 40 7 23 16 25 32 9z" />
                <path d="M2462 1091 c-11 -7 -10 -9 2 -14 10 -4 16 -18 16 -36 0 -16 5 -33 11
-37 8 -5 9 6 4 37 -8 51 -15 61 -33 50z" />
                <path d="M2240 1061 c0 -11 -3 -27 -7 -37 -4 -12 -3 -15 5 -10 7 4 12 16 12
26 0 10 8 24 18 29 15 9 15 10 -5 11 -16 0 -23 -6 -23 -19z" />
                <path d="M2287 1064 c-10 -11 -8 -52 3 -59 6 -3 7 1 4 9 -5 12 1 16 21 16 20
0 26 4 23 18 -3 17 -38 29 -51 16z m43 -14 c0 -5 -7 -10 -15 -10 -8 0 -15 5
-15 10 0 6 7 10 15 10 8 0 15 -4 15 -10z" />
                <path d="M2388 1033 c7 -3 16 -2 19 1 4 3 -2 6 -13 5 -11 0 -14 -3 -6 -6z" />
                <path d="M2535 1020 c3 -5 11 -10 16 -10 6 0 7 5 4 10 -3 6 -11 10 -16 10 -6
0 -7 -4 -4 -10z" />
                <path d="M2060 2180 c-9 -6 -10 -10 -3 -10 6 0 15 5 18 10 8 12 4 12 -15 0z" />
                <path d="M2783 1915 c4 -22 7 -48 7 -57 0 -14 8 -18 33 -17 29 1 30 2 7 8 -20
6 -26 15 -31 49 -3 23 -9 45 -14 49 -4 5 -5 -10 -2 -32z" />
                <path d="M2700 1898 c-6 -24 -13 -49 -15 -55 -2 -7 0 -13 5 -13 6 0 10 7 10
15 0 18 41 20 58 3 7 -7 12 -9 12 -5 0 14 -44 97 -52 97 -4 0 -12 -19 -18 -42z
m40 -20 c0 -5 -7 -8 -15 -8 -15 0 -20 21 -8 33 7 7 23 -11 23 -25z" />
                <path d="M2558 1878 c5 -55 8 -65 18 -55 8 8 -6 107 -15 107 -5 0 -6 -24 -3
-52z" />
                <path d="M2600 1881 c0 -28 5 -53 10 -56 6 -4 10 5 10 19 0 21 5 26 24 26 28
0 42 26 25 46 -6 8 -24 14 -40 14 -28 0 -29 -2 -29 -49z m58 16 c3 -14 -1 -18
-20 -15 -12 2 -24 11 -26 21 -3 14 1 18 20 15 12 -2 24 -11 26 -21z" />
                <path d="M2421 1881 l-1 -44 -35 39 -34 39 -1 -57 c0 -32 4 -58 10 -58 6 0 10
16 10 35 l0 35 29 -32 c16 -18 33 -30 37 -26 4 4 2 31 -3 60 l-10 53 -2 -44z" />
                <path d="M2471 1906 c-17 -20 -10 -77 12 -90 19 -12 48 0 55 25 3 9 -2 8 -16
-5 -18 -15 -24 -16 -37 -6 -17 14 -19 47 -5 70 8 12 13 13 30 3 27 -17 35 -16
20 2 -16 19 -44 19 -59 1z" />
                <path d="M2214 1886 c-3 -8 -1 -34 4 -58 6 -24 10 -33 11 -20 1 12 7 22 15 22
7 0 21 -10 29 -22 13 -19 16 -20 16 -6 1 9 -3 20 -9 23 -6 4 -5 13 2 25 9 14
9 22 -1 34 -17 20 -60 21 -67 2z m53 -12 c6 -16 -15 -37 -29 -28 -4 3 -8 14
-8 25 0 23 28 26 37 3z" />
                <path d="M2311 1853 c-1 -28 4 -55 9 -58 12 -8 12 61 0 90 -6 15 -9 6 -9 -32z" />
                <path d="M2120 1835 c0 -30 5 -55 10 -55 6 0 10 9 10 19 0 12 9 21 24 25 51
13 38 66 -15 66 -28 0 -29 -1 -29 -55z m57 29 c5 -14 -11 -33 -28 -34 -10 0
-20 31 -13 41 9 15 34 10 41 -7z" />
                <path d="M2002 1871 c-10 -6 -12 -21 -7 -55 7 -45 8 -46 44 -44 l36 1 -33 4
c-40 5 -41 33 -2 44 l25 7 -27 1 c-17 1 -28 7 -28 15 0 8 12 19 28 24 l27 10
-25 1 c-14 0 -31 -3 -38 -8z" />
                <path d="M1910 1833 c0 -59 8 -73 41 -73 16 0 29 4 29 8 0 5 -10 8 -22 8 -20
-1 -23 5 -26 39 -5 56 -22 70 -22 18z" />
                <path d="M2716 1763 c-27 -4 -28 -7 -22 -41 3 -20 6 -45 6 -54 0 -13 8 -18 29
-18 17 0 33 5 37 11 5 8 -1 10 -18 6 -19 -5 -28 -2 -32 9 -9 23 -8 24 14 24
11 0 20 4 20 9 0 5 -9 7 -20 4 -15 -4 -20 0 -20 16 0 16 6 21 25 21 14 0 25 5
25 10 0 6 -3 9 -7 9 -5 -1 -21 -4 -37 -6z" />
                <path d="M2599 1743 c-3 -21 4 -89 9 -98 3 -5 9 1 12 15 4 15 14 26 27 28 26
4 38 29 22 48 -12 15 -68 20 -70 7z m56 -23 c0 -22 -39 -19 -43 3 -3 15 1 18
20 15 12 -2 23 -10 23 -18z" />
                <path d="M2461 1703 c0 -21 4 -47 9 -58 6 -15 9 -6 9 32 1 28 -3 55 -9 58 -6
4 -10 -9 -9 -32z" />
                <path d="M2501 1723 c1 -32 17 -99 18 -76 1 14 11 25 32 32 24 8 30 15 27 33
-2 19 -10 24 -40 26 -31 3 -38 0 -37 -15z m62 -7 c3 -8 -1 -17 -9 -20 -26 -10
-34 -7 -34 14 0 23 35 28 43 6z" />
                <path d="M2380 1678 c0 -54 2 -58 23 -58 12 0 29 5 37 10 12 8 9 10 -12 10
-25 0 -28 4 -28 33 0 17 -5 39 -10 47 -7 11 -10 -2 -10 -42z" />
                <path d="M2197 1702 c-21 -23 -22 -66 -1 -86 8 -9 18 -16 20 -16 14 0 44 22
44 32 0 9 -3 9 -12 0 -21 -21 -45 -14 -52 15 -10 37 16 63 44 45 11 -7 20 -8
20 -2 0 8 -31 30 -43 30 -2 0 -11 -8 -20 -18z" />
                <path d="M2301 1698 c-5 -13 -11 -39 -15 -58 -6 -31 -5 -33 7 -17 16 20 53 23
60 5 2 -7 7 -10 11 -6 8 7 -28 83 -44 93 -5 3 -14 -4 -19 -17z m29 -28 c0 -11
-4 -20 -10 -20 -5 0 -10 9 -10 20 0 11 5 20 10 20 6 0 10 -9 10 -20z" />
                <path d="M1969 1666 c-13 -28 6 -79 32 -84 18 -3 54 27 44 36 -3 4 -10 0 -14
-7 -16 -25 -46 -8 -49 27 -4 36 18 53 43 32 12 -10 15 -9 15 4 0 27 -58 21
-71 -8z" />
                <path d="M1846 1641 c-3 -4 6 -13 19 -19 27 -12 33 -4 13 16 -14 14 -25 15
-32 3z" />
                <path d="M2111 1504 c-83 -41 -151 -79 -151 -83 0 -5 69 27 152 70 84 42 157
75 162 72 5 -4 6 -1 2 5 -4 7 -9 12 -10 12 -2 0 -71 -34 -155 -76z" />
                <path d="M1986 1482 c-3 -5 1 -9 9 -9 8 0 12 4 9 9 -3 4 -7 8 -9 8 -2 0 -6 -4
-9 -8z" />
                <path d="M1849 2473 c-13 -17 -13 -17 6 -3 11 8 22 16 24 17 2 2 0 3 -6 3 -6
0 -17 -8 -24 -17z" />
                <path d="M1859 2453 c-13 -16 -12 -17 4 -4 9 7 17 15 17 17 0 8 -8 3 -21 -13z" />
                <path d="M3150 2166 c0 -2 8 -10 18 -17 15 -13 16 -12 3 4 -13 16 -21 21 -21
13z" />
                <path d="M271 437 c-8 -10 -7 -14 2 -14 8 0 14 6 14 14 0 7 -1 13 -2 13 -2 0
-8 -6 -14 -13z" />
            </g>
        </svg>

        <svg width="250" height="250" viewBox="0 0 250 250" version="1.1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink" id="principal-stamp">
            <g transform="rotate(5 125 125)">
                <circle class="Rang" cx="125" cy="125" r="123.5" fill="none" stroke="#000091" stroke-width="3"
                    layer="0"></circle>
                <circle class="Rang" cx="125" cy="125" r="117.75" fill="none" stroke="#000091" stroke-width="2"
                    layer="1"></circle>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(0, 125, 125)" textLength="314.1814" layer="2">
                    <defs>
                        <path id="kkZTKNKV7Cl82"
                            d="M 125 125 m -98.3, 0 a 98.3,98.3 0 1,1 196.6,0 a 98.3,98.3 0 1,1 -196.6,0"></path>
                    </defs>
                    <textPath href="#kkZTKNKV7Cl82" xlink:href="#kkZTKNKV7Cl82" textLength="314.1814">Coll√®ge Katherine
                        Johnson&nbsp;</textPath>
                </text>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(-5 125 125)" textLength="332.48252" layer="4">
                    <defs>
                        <path id="hQVwZLlstvF54" d="M 125 125 m -112, 0 a 112,112 0 1,0 224,0 a 112,112 0 1,0 -224,0">
                        </path>
                    </defs>
                    <textPath href="#hQVwZLlstvF54" xlink:href="#hQVwZLlstvF54" textLength="332.48252">Bd du Bhosphore
                        13015 MARSEILLE</textPath>
                </text>
                <circle class="Rang" cx="125" cy="125" r="91.5" fill="none" stroke="#000091" stroke-width="2" layer="5">
                </circle>
                <text x="125" y="112.5" layer="6" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    font-weight="bold" transform="rotate(0 125 112.5)">
                    <tspan dy="6.75" text-anchor="middle">LE PRINCIPAL</tspan>
                </text>
                <text x="125" y="142.5" layer="7" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    transform="rotate(0 125 142.5)">
                    <tspan dy="6.75" text-anchor="middle">C. CALIPPE</tspan>
                </text>
            </g>
        </svg>
        <svg width="250" height="250" viewBox="0 0 250 250" version="1.1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink" id="adjoint-stamp">
            <g transform="rotate(5 125 125)">
                <circle class="Rang" cx="125" cy="125" r="123.5" fill="none" stroke="#000091" stroke-width="3"
                    layer="0"></circle>
                <circle class="Rang" cx="125" cy="125" r="117.75" fill="none" stroke="#000091" stroke-width="2"
                    layer="1"></circle>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(0, 125, 125)" textLength="314.1814" layer="2">
                    <defs>
                        <path id="kkZTKNKV7Cl82"
                            d="M 125 125 m -98.3, 0 a 98.3,98.3 0 1,1 196.6,0 a 98.3,98.3 0 1,1 -196.6,0"></path>
                    </defs>
                    <textPath href="#kkZTKNKV7Cl82" xlink:href="#kkZTKNKV7Cl82" textLength="314.1814">Coll√®ge Katherine
                        Johnson&nbsp;</textPath>
                </text>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(-5 125 125)" textLength="332.48252" layer="4">
                    <defs>
                        <path id="hQVwZLlstvF54" d="M 125 125 m -112, 0 a 112,112 0 1,0 224,0 a 112,112 0 1,0 -224,0">
                        </path>
                    </defs>
                    <textPath href="#hQVwZLlstvF54" xlink:href="#hQVwZLlstvF54" textLength="332.48252">Bd du Bhosphore
                        13015 MARSEILLE</textPath>
                </text>
                <circle class="Rang" cx="125" cy="125" r="91.5" fill="none" stroke="#000091" stroke-width="2" layer="5">
                </circle>
                <text x="125" y="112.5" layer="6" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    font-weight="bold" transform="rotate(0 125 112.5)">
                    <tspan dy="6.75" text-anchor="middle">LE PRINCIPAL</tspan>
                </text>
                <text x="125" y="132.5" layer="8" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    font-weight="bold" transform="rotate(0 125 112.5)">
                    <tspan dy="6.75" text-anchor="middle">ADJOINT</tspan>
                </text>
                <text x="125" y="164.5" layer="7" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    transform="rotate(0 125 142.5)">
                    <tspan dy="6.75" text-anchor="middle">C. AUBES</tspan>
                </text>
            </g>
        </svg>
        <svg width="250" height="250" viewBox="0 0 250 250" version="1.1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink" id="secretariat-stamp">
            <g transform="rotate(5 125 125)">
                <circle class="Rang" cx="125" cy="125" r="123.5" fill="none" stroke="#000091" stroke-width="3"
                    layer="0"></circle>
                <circle class="Rang" cx="125" cy="125" r="117.75" fill="none" stroke="#000091" stroke-width="2"
                    layer="1"></circle>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(0, 125, 125)" textLength="314.1814" layer="2">
                    <defs>
                        <path id="kkZTKNKV7Cl82"
                            d="M 125 125 m -98.3, 0 a 98.3,98.3 0 1,1 196.6,0 a 98.3,98.3 0 1,1 -196.6,0"></path>
                    </defs>
                    <textPath href="#kkZTKNKV7Cl82" xlink:href="#kkZTKNKV7Cl82" textLength="314.1814">Coll√®ge Katherine
                        Johnson&nbsp;</textPath>
                </text>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(-5 125 125)" textLength="332.48252" layer="4">
                    <defs>
                        <path id="hQVwZLlstvF54" d="M 125 125 m -112, 0 a 112,112 0 1,0 224,0 a 112,112 0 1,0 -224,0">
                        </path>
                    </defs>
                    <textPath href="#hQVwZLlstvF54" xlink:href="#hQVwZLlstvF54" textLength="332.48252">Bd du Bhosphore
                        13015 MARSEILLE</textPath>
                </text>
                <circle class="Rang" cx="125" cy="125" r="91.5" fill="none" stroke="#000091" stroke-width="2" layer="5">
                </circle>
                <text x="125" y="112.5" layer="6" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    font-weight="bold" transform="rotate(0 125 112.5)">
                    <tspan dy="6.75" text-anchor="middle">SECR√âTARIAT</tspan>
                </text>
                <text x="125" y="142.5" layer="7" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    transform="rotate(0 125 142.5)">
                    <tspan dy="6.75" text-anchor="middle">L. ZERRAD</tspan>
                </text>
            </g>
        </svg>
        <svg width="250" height="250" viewBox="0 0 250 250" version="1.1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink" id="gestion-stamp">
            <g transform="rotate(5 125 125)">
                <circle class="Rang" cx="125" cy="125" r="123.5" fill="none" stroke="#000091" stroke-width="3"
                    layer="0"></circle>
                <circle class="Rang" cx="125" cy="125" r="117.75" fill="none" stroke="#000091" stroke-width="2"
                    layer="1"></circle>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(0, 125, 125)" textLength="314.1814" layer="2">
                    <defs>
                        <path id="kkZTKNKV7Cl82"
                            d="M 125 125 m -98.3, 0 a 98.3,98.3 0 1,1 196.6,0 a 98.3,98.3 0 1,1 -196.6,0"></path>
                    </defs>
                    <textPath href="#kkZTKNKV7Cl82" xlink:href="#kkZTKNKV7Cl82" textLength="314.1814">Coll√®ge Katherine
                        Johnson&nbsp;</textPath>
                </text>
                <text font-size="18" font-style="normal" font-family="Marianne" fill="#000091" stroke="none"
                    font-weight="bold" transform="rotate(-5 125 125)" textLength="332.48252" layer="4">
                    <defs>
                        <path id="hQVwZLlstvF54" d="M 125 125 m -112, 0 a 112,112 0 1,0 224,0 a 112,112 0 1,0 -224,0">
                        </path>
                    </defs>
                    <textPath href="#hQVwZLlstvF54" xlink:href="#hQVwZLlstvF54" textLength="332.48252">Bd du Bhosphore
                        13015 MARSEILLE</textPath>
                </text>
                <circle class="Rang" cx="125" cy="125" r="91.5" fill="none" stroke="#000091" stroke-width="2" layer="5">
                </circle>
                <text x="125" y="112.5" layer="6" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    font-weight="bold" transform="rotate(0 125 112.5)">
                    <tspan dy="6.75" text-anchor="middle">SERVICE</tspan>
                </text>
                <text x="125" y="142.5" layer="7" fill="#000091" stroke="none" font-size="22" font-family="Marianne"
                    transform="rotate(0 125 142.5)">
                    <tspan dy="6.75" text-anchor="middle">GESTION</tspan>
                </text>
            </g>
        </svg>
    </div>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';
        const { PDFDocument } = PDFLib;
        let fabricCanvas, currentPdfBytes, pdfDocJS;
        let currentPageNum = 1, totalPages = 1;
        let selectedV = 'bottom', selectedH = 'right';
        let currentZoom = 1;
        let originalFileName = "document";
        window.onload = () => {
            fabricCanvas = new fabric.Canvas('pdf-canvas');
            setupPreviews();
            loadPrefs();
            // Gestion des positions
            document.querySelectorAll('.pos-btn').forEach(btn => {
                btn.onclick = (e) => {
                    document.querySelectorAll('.pos-btn').forEach(b => b.classList.remove('selected'));
                    e.target.classList.add('selected');
                    selectedV = e.target.dataset.v;
                    selectedH = e.target.dataset.h;
                };
            });
            // Corbeille flottante
            const delControl = document.getElementById('delete-control');
            const scrollContainer = document.getElementById('scroll-container');  // Ajout: r√©f√©rence au conteneur scroll
            fabricCanvas.on('selection:created', () => updateDelPos(delControl, scrollContainer));
            fabricCanvas.on('selection:updated', () => updateDelPos(delControl, scrollContainer));
            fabricCanvas.on('moving', () => updateDelPos(delControl, scrollContainer));
            fabricCanvas.on('selection:cleared', () => delControl.style.display = 'none');
            // Ajout: listener pour clic sur le bouton delete (utilise addEventListener pour coh√©rence)
            delControl.addEventListener('click', removeSelected);
            // Ajout: listener clavier pour supprimer (Delete ou Backspace) quand un objet est s√©lectionn√©
            window.addEventListener('keydown', (e) => {
                if ((e.key === 'Delete' || e.key === 'Backspace') && fabricCanvas.getActiveObject()) {
                    removeSelected();
                }
            });
            function updateDelPos(delControl, scrollContainer) {  // Modif: fonction avec params, calcule en pixels visibles
                const obj = fabricCanvas.getActiveObject();
                if (!obj) return;
                const rect = obj.getBoundingRect();
                const pixelTop = rect.top * currentZoom;
                const pixelLeft = rect.left * currentZoom;
                const pixelWidth = rect.width * currentZoom;
                delControl.style.display = 'block';
                delControl.style.top = (pixelTop - scrollContainer.scrollTop - 10) + 'px';
                delControl.style.left = (pixelLeft - scrollContainer.scrollLeft + pixelWidth - 15) + 'px';
            }
            // Navigation
            const pInput = document.getElementById('current-page-input');
            pInput.onchange = () => {
                let v = Math.max(1, Math.min(totalPages, parseInt(pInput.value) || 1));
                pInput.value = v; renderPage(v);
            };
            document.getElementById('btn-clear-page').onclick = () => {
                if (confirm(`Vider la page ${currentPageNum} ?`)) {
                    fabricCanvas.getObjects().filter(o => o.pageRef === currentPageNum).forEach(o => fabricCanvas.remove(o));
                    fabricCanvas.discardActiveObject().renderAll();
                    updateStats();
                }
            };
            document.getElementById('zoom-select').onchange = (e) => {
                applyZoom(parseFloat(e.target.value));
            };
        };
        function applyZoom(zoomLevel) {
            currentZoom = zoomLevel;
            // On d√©finit le zoom par rapport au coin sup√©rieur gauche
            fabricCanvas.setZoom(zoomLevel);
            // On ajuste la taille du conteneur de dessin pour que les scrollbars apparaissent
            fabricCanvas.setWidth(fabricCanvas.backgroundImage.width * zoomLevel);
            fabricCanvas.setHeight(fabricCanvas.backgroundImage.height * zoomLevel);
            fabricCanvas.renderAll();
        }
        async function renderPage(num) {
            currentPageNum = num;
            document.getElementById('current-page-input').value = num;
            const page = await pdfDocJS.getPage(num);
            const viewport = page.getViewport({ scale: 1.5 }); // On garde une base haute d√©finition
            const tempCanvas = document.createElement('canvas');
            const context = tempCanvas.getContext('2d');
            tempCanvas.height = viewport.height;
            tempCanvas.width = viewport.width;
            await page.render({ canvasContext: context, viewport }).promise;
            fabric.Image.fromURL(tempCanvas.toDataURL(), (img) => {
                // Appliquer le fond
                fabricCanvas.setBackgroundImage(img, () => {
                    // Ajuster le canvas √† la taille du fond multipli√©e par le zoom actuel
                    applyZoom(currentZoom);
                    // G√©rer la visibilit√© des objets
                    fabricCanvas.getObjects().forEach(o => {
                        if (o !== fabricCanvas.backgroundImage) {
                            o.visible = o.evented = (o.pageRef === currentPageNum);
                        }
                    });
                    fabricCanvas.discardActiveObject().renderAll();
                    updateStats();
                });
            });
        }
        function removeSelected() {
            if (fabricCanvas.getActiveObject()) {
                fabricCanvas.remove(fabricCanvas.getActiveObject());
                fabricCanvas.discardActiveObject().renderAll();
                updateStats();
            }
        }
        function setupPreviews() {
            const ids = ['principalsign-stamp', 'principal-stamp', 'adjoint-stamp', 'secretariat-stamp', 'gestion-stamp'];
            ids.forEach((id, i) => document.getElementById('p' + (i + 1)).innerHTML = document.getElementById(id).outerHTML);
        }
        const fIn = document.getElementById('file-input');
        document.getElementById('drop-zone').onclick = () => fIn.click();
        fIn.onchange = async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            // Sauvegarde du nom sans l'extension
            originalFileName = file.name.replace(/\.[^/.]+$/, "");
            // On r√©cup√®re les donn√©es
            const buffer = await file.arrayBuffer();
            // CRUCIAL : On cr√©e une copie pour pdf-lib (export)
            // afin que pdf.js ne "d√©tache" pas le buffer principal
            currentPdfBytes = buffer.slice(0);
            document.getElementById('file-info').innerText = file.name;
            // On utilise le buffer original pour l'affichage
            pdfDocJS = await pdfjsLib.getDocument({ data: buffer }).promise;
            totalPages = pdfDocJS.numPages;
            document.getElementById('total-pages').innerText = totalPages;
            document.getElementById('btn-export').disabled = false;
            renderPage(1);
        };
        function selectStamp(el) {
            document.querySelectorAll('.stamp-card').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            addStamp(el.dataset.stamp);
        }
        function addStamp(id) {
            const svgData = new XMLSerializer().serializeToString(document.getElementById(id));
            const size = parseInt(document.getElementById('pref-size').value) || 100;  // Taille logique fixe
            // Ajout: calcul en coordonn√©es logiques (non zoom√©es)
            const unzoomedW = fabricCanvas.backgroundImage.width;
            const unzoomedH = fabricCanvas.backgroundImage.height;
            const logicalPad = 20;  // Padding logique fixe
            let l, t;
            if (selectedH === 'left') l = logicalPad;
            else if (selectedH === 'center') l = (unzoomedW / 2) - (size / 2);
            else l = unzoomedW - size - logicalPad;
            if (selectedV === 'top') t = logicalPad;
            else if (selectedV === 'middle') t = (unzoomedH / 2) - (size / 2);
            else t = unzoomedH - size - logicalPad;
            fabric.loadSVGFromString(svgData, (objs, opts) => {
                const s = fabric.util.groupSVGElements(objs, opts);
                s.set({
                    left: l,
                    top: t,
                    stampId: id,
                    pageRef: currentPageNum,
                    cornerColor: '#000091',
                    unzoomedPageWidth: unzoomedW,  // Ajout: stocker pour export pr√©cis par page
                    unzoomedPageHeight: unzoomedH
                });
                s.scaleToWidth(size);  // Scale logique fixe
                fabricCanvas.add(s).setActiveObject(s).renderAll();
                updateStats();
            });
        }
        function updateStats() {
            document.getElementById('stat-count').innerText = fabricCanvas.getObjects().filter(o => o !== fabricCanvas.backgroundImage).length;
        }
        document.getElementById('prev-page').onclick = () => { if (currentPageNum > 1) renderPage(currentPageNum - 1); };
        document.getElementById('next-page').onclick = () => { if (currentPageNum < totalPages) renderPage(currentPageNum + 1); };
        function loadPrefs() {
            const s = localStorage.getItem('stampSize'), v = localStorage.getItem('stampV'), h = localStorage.getItem('stampH');
            if (s) document.getElementById('pref-size').value = s;
            if (v && h) { selectedV = v; selectedH = h; }
            document.querySelectorAll('.pos-btn').forEach(b => b.classList.remove('selected'));
            const target = document.querySelector(`.pos-btn[data-v="${selectedV}"][data-h="${selectedH}"]`);
            if (target) target.classList.add('selected');
        }
        document.getElementById('btn-save-prefs').onclick = () => {
            localStorage.setItem('stampSize', document.getElementById('pref-size').value);
            localStorage.setItem('stampV', selectedV); localStorage.setItem('stampH', selectedH);
            alert("R√©glages sauv√©s !");
        };
        document.getElementById('btn-export').onclick = async () => {
            const pdfDoc = await PDFDocument.load(currentPdfBytes.slice(0));
            const pages = pdfDoc.getPages();
            for (const o of fabricCanvas.getObjects()) {
                if (o === fabricCanvas.backgroundImage) continue;
                const page = pages[o.pageRef - 1];
                const { width, height } = page.getSize();
                // Modif: utilise les dims logiques stock√©es par tampon (ind√©pendant du zoom et de la page courante)
                const rx = width / o.unzoomedPageWidth;
                const ry = height / o.unzoomedPageHeight;
                const pngBytes = await svgToPng(document.getElementById(o.stampId));
                const img = await pdfDoc.embedPng(pngBytes);
                page.drawImage(img, {
                    x: o.left * rx,
                    y: height - (o.top * ry) - (o.getScaledHeight() * ry),
                    width: o.getScaledWidth() * rx,
                    height: o.getScaledHeight() * ry,
                    rotate: PDFLib.degrees(-o.angle || 0)
                });
            }
            const pdfDataUri = await pdfDoc.save();
            const link = document.createElement('a');
            link.href = URL.createObjectURL(new Blob([pdfDataUri], { type: "application/pdf" }));
            link.download = `${originalFileName}_endosse.pdf`;
            link.click();
        };
        async function svgToPng(svg) {
            return new Promise(res => {
                const canvas = document.createElement('canvas');
                canvas.width = canvas.height = 600;
                const img = new Image();
                img.onload = () => {
                    canvas.getContext('2d').drawImage(img, 0, 0, 600, 600);
                    canvas.toBlob(b => {
                        const r = new FileReader();
                        r.onloadend = () => res(new Uint8Array(r.result));
                        r.readAsArrayBuffer(b);
                    }, 'image/png');
                };
                img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(new XMLSerializer().serializeToString(svg))));
            });
        }
    </script>
</body>

</html>
